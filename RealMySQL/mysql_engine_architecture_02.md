# 아키텍처 (MySQL Engine)

## 메모리 할당 및 사용 구조

![](img/memory01.png)

MySQL에서 사용되는 메모리 공간은 `글로벌 메모리 영역`과 `로컬 메모리 영역`으로 구분할 수 있다.  

`글로벌 메모리 영역`의 모든 메모리 공간은  
MySQL의 시스템 변수로 설정해 둔 만큼 MySQL 서버가 시작하면서 운영체제로 부터 할당 받는다.

#

## 글로벌 메모리 영역

> 테이블 캐시  
> InnoDB 버퍼 풀  
> InnoDB 어댑티브 해시 인덱스  
> InnoDB 리두 로그 버퍼  

일반적으로 `클라이언트 스레드의 수와 무관`하게 `하나의 메모리 공간만 할당`된다.  
이 메모리 공간은 생성된 글로벌 영역이 N개라 하더라도 모든 스레드에 의해 공유된다.  

## 로컬 메모리 영역 (세션 메모리 영역)

> Sort 버퍼  
> 조인 버퍼  
> 바이너리 로그 캐시  
> 네트워크 버퍼

MySQL 서버상에 존재하는 클라이언트 스레드가 쿼리를 처리하는데 사용하는 메모리 영역이다.  
  
로컬 메모리는 `각 클라이언트 스레드 별로 독립적으로 할당`되며 절대 공유되어 사용되지 않는다는 특징이 있다.  
Sort 버퍼나 조인 버퍼의 경우, 필요할 때만 공간이 할당되고 필요하지 않은 경우에는 MySQL이 메모리 공간을 할당조차 하지 않을 수 있다.  

로컬 메모리 공간은 `커넥션이 열려있는 동안 계속 할당`된 상태로 남아 있는 공간도 있고 (`커넥션 버퍼`, `결과 버퍼`)  
`쿼리를 실행하는 순간에만 할당`했다가 다시 해제하는 공간도 있다. (`Sort 버퍼`, `조인 버퍼`)
## Reference

**위 내용은 책 RealMySQL 8.0을 구입하여 읽고 정리하였습니다.**
- [도서 홈페이지 https://wikibook.co.kr/realmysql801/](https://wikibook.co.kr/realmysql801/)
