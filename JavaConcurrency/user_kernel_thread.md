# 사용자 수준 스레드 & 커널 수준 스레드

스레드는 관리 방식에 따라 `사용자 수준 스레드(User Level Thread)`와 `커널 수준 스레드(Kernel Level Thread)`로 구분할 수 있다.
이 둘은 스레드를 관리하고 실행하는 주체가 다르며, 각각의 특징이 있다.

## 사용자 수준 스레드

사용자 수준 스레드는 사용자 프로그램에서 관리하는 스레드를 말한다.
  
사용자 영역에서 스레드 라이브러리(Pthreads, Window Threads, Java Thread(JVM))에 의해 스레드의 생성과 종료, 스레드간 메시지 전달,
스레드의 스켸줄링 보관 등 모든 것을 관리한다.
  
커널은 사용자 수준 스레드에 대해 인식하지 못하며 단일 스레드 프로세스로 취급하고 관리한다.  
커널은 이 프로세스를 스케줄링할 때, 단순히 하나의 스레드가 있는 것으로 간주하고 해당 프로세스 전체에 대해 CPU 자원을 할당한다.

## 커널 수준 스레드

커널 수준 스레드는 운영 체제의 커널이 직접 관리하는 스레드를 말한다.
  
커널이 스레드와 관련된 모든 작업(PCB, TCB 관리/유지)을 관리하고, 커널 스레드의 모든 정보를 알고 있어 커널 스레드는 OS 스케줄러에 의해 스케줄링 된다.
CPU는 커널에 의해 생성된 커널 스레드의 실행만을 담당한다.

## 멀티 스레딩 모델

**CPU는 OS 스케줄러가 예약하는 커널 스레드만 직접적으로 실행시킬 수 있다.** 따라서 사용자 수준 스레드는 커널 수준 스레드와의 매핑이 필요하다.
  
사용자 수준 스레드는 세 가지 모델로 커널 수준 스레드와 매핑하여 구현할 수 있다.
- 다대일 스레드 매핑, 일대일 스레드 매핑, 다대다 스레드 매핑

### 다대일 스레드 매핑

다수의 사용자 수준 스레드가 커널 수준 스레드 한 개에 매핑하는 유형으로 사용자 수준의 스레드 모델이라 볼 수 있다.

![image](https://github.com/user-attachments/assets/d5cde08f-0f2e-4834-9970-e4cc67a6ffed)

**사용자 프로그램의 스레드 라이브러리가 사용자 수준 스레드의 모든 것들을 관리**하고,  
커널 영역과 사용자 영역은 완전히 분리되어 **CPU는 커널 스레드만 인식하고 실행**한다.
  
- 커널 개입 없이 사용자 스레드끼리의 스위칭이 발생하기 때문에 오버헤드가 적다.  
- 스케줄링이나 동기화를 하려고 커널을 호출하지 않으므로 커널 영역으로 전환하는 오버헤드가 줄어든다.
- 개별 스레드 단위가 아닌 단일 프로세스 단위로 CPU 코어를 할당하기 때문에 멀티코어를 활용한 병렬처리가 불가능하다.
- 프로세스 내의 하나의 사용자 수준 스레드가 I/O 작업으로 인해 시스템 호출을 수행하면, 커널은 해당 프로세스를 단일 스레드로 인식하기 때문에 프로세스 전체가 블로킹된 것으로 간주한다. 즉 이 프로세스 내의 다른 사용자 수준 스레드들도 CPU를 사용할 수 없게 된다.

전통적인 스레드 라이브러리에서 사용되었으나 현재는 많이 사용되지 않는다.  
자바 초기 버전의 Green Thread가 이 모델에 해당한다고 볼 수 있다.

### 

